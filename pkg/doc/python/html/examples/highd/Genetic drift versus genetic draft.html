

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Genetic drift versus genetic draft &mdash; FFPopSim 1.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="FFPopSim 1.1 documentation" href="../../index.html" />
    <link rel="next" title="Condensation of genotypes driven by epistasis" href="Condensation of genotypes driven by epistasis.html" />
    <link rel="prev" title="Genetic drift" href="Genetic drift.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Condensation of genotypes driven by epistasis.html" title="Condensation of genotypes driven by epistasis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Genetic drift.html" title="Genetic drift"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">FFPopSim 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="genetic-drift-versus-genetic-draft">
<h1>Genetic drift versus genetic draft<a class="headerlink" href="#genetic-drift-versus-genetic-draft" title="Permalink to this headline">Â¶</a></h1>
<p>The next examples explores the interplay between genetic drift and
genetic draft, i.e., the effect of linked selection on the
trajectories of neutral alleles. The basic script is the same as
above, only that we now set a fitness landscape and change the effects
of some mutations from being deleterious to beneficial during the
simulation. This generates selective sweeps.</p>
<p>After importing the relevant modules, we build the population:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">L</span><span class="o">=</span><span class="mi">256</span>                                           <span class="c"># simulate 256 loci</span>

<span class="n">pop</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">haploid_highd</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>                        <span class="c"># produce an instance of haploid_lowd with L loci</span>
<span class="n">pop</span><span class="o">.</span><span class="n">carrying_capacity</span> <span class="o">=</span> <span class="mi">50000</span>                   <span class="c"># set the average population size to 50000</span>
<span class="n">pop</span><span class="o">.</span><span class="n">outcrossing_rate</span> <span class="o">=</span> <span class="mi">1</span>                        <span class="c"># make the species obligate outcrossing</span>
<span class="n">pop</span><span class="o">.</span><span class="n">crossover_rate</span> <span class="o">=</span> <span class="mf">0.02</span><span class="o">/</span><span class="n">pop</span><span class="o">.</span><span class="n">L</span>                 <span class="c"># set the crossover rate of the segment to 2 centimorgans</span>
<span class="n">pop</span><span class="o">.</span><span class="n">mutation_rate</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">/</span><span class="n">pop</span><span class="o">.</span><span class="n">carrying_capacity</span>   <span class="c"># per locus mutation rate equal to 0.1/N</span>
</pre></div>
</div>
<p>In addition, we set the selection coefficients to 0 for most loci, but
make every 10th locus strongly deleterious:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span><span class="o">=</span><span class="mi">10</span>
<span class="n">selection_coefficients</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>                 <span class="c"># most loci are neutral</span>
<span class="n">selection_coefficients</span><span class="p">[::</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>                          <span class="c"># every m-th locus is strongly deleterious</span>
<span class="n">pop</span><span class="o">.</span><span class="n">set_trait_additive</span><span class="p">(</span><span class="n">selection_coefficients</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>            <span class="c"># trait 0 is by default fitness</span>
</pre></div>
</div>
<p>Neutral loci are set the frequency 1/2, while the deleterious ones to
frequency 0. We initialize the population with those allele frequencies,
in linkage equilibrium:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">initial_allele_frequencies</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="n">initial_allele_frequencies</span><span class="p">[::</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pop</span><span class="o">.</span><span class="n">set_allele_frequencies</span><span class="p">(</span><span class="n">initial_allele_frequencies</span><span class="p">,</span> <span class="n">pop</span><span class="o">.</span><span class="n">carrying_capacity</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we start evolving and track the allele frequencies as we go
along. Every 200 generations, we pick a random locus from the
deleterious ones and make it beneficial.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#evolve for 2000 generations and track the allele frequencies</span>
<span class="n">maxgen</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">allele_frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="n">pop</span><span class="o">.</span><span class="n">get_allele_frequencies</span><span class="p">()]</span>
<span class="n">tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">pop</span><span class="o">.</span><span class="n">generation</span><span class="p">]</span>
<span class="k">while</span> <span class="n">pop</span><span class="o">.</span><span class="n">generation</span><span class="o">&lt;</span><span class="n">maxgen</span><span class="p">:</span>
    <span class="n">pop</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>                                                  <span class="c"># procede 10 generations</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">generation</span><span class="o">%</span><span class="mi">200</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>                                     <span class="c"># every 200 generations, make one of the deleterious mutations beneficial</span>
        <span class="k">print</span> <span class="s">&quot;generation:&quot;</span><span class="p">,</span> <span class="n">pop</span><span class="o">.</span><span class="n">generation</span><span class="p">,</span> <span class="s">&#39;out of&#39;</span><span class="p">,</span> <span class="n">maxgen</span>
        <span class="n">selection_coefficients</span><span class="p">[</span><span class="n">m</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="n">pop</span><span class="o">.</span><span class="n">set_trait_additive</span><span class="p">(</span><span class="n">selection_coefficients</span><span class="p">)</span>              <span class="c"># update fitness function</span>

<span class="n">allele_frequencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">get_allele_frequencies</span><span class="p">())</span>             <span class="c"># save the allele frequencies</span>
<span class="n">tp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">generation</span><span class="p">)</span>                                           <span class="c"># and the associated generation</span>
</pre></div>
</div>
<p>We now plot the frequency trajectories of all selected loci. Those
that become beneficial in the process have risen quickly to high
frequencies. When they sweep, they influence the trajectories of
linked neutral loci, of which also a few trajectories are shown.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">locus</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pop</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>         <span class="c">#plot the allele frequency trajectories of the selected mutations</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">allele_frequencies</span><span class="p">[:,</span><span class="n">locus</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">cool</span><span class="p">(</span><span class="n">locus</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">locus</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">pop</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="mi">50</span><span class="p">):</span>        <span class="c">#plot a few neutral trajectories</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">allele_frequencies</span><span class="p">[:,</span><span class="n">locus</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">cool</span><span class="p">(</span><span class="n">locus</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/drift_and_draft.png" src="../../_images/drift_and_draft.png" />
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="Genetic drift.html"
                        title="previous chapter">Genetic drift</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Condensation of genotypes driven by epistasis.html"
                        title="next chapter">Condensation of genotypes driven by epistasis</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/examples/highd/Genetic drift versus genetic draft.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Condensation of genotypes driven by epistasis.html" title="Condensation of genotypes driven by epistasis"
             >next</a> |</li>
        <li class="right" >
          <a href="Genetic drift.html" title="Genetic drift"
             >previous</a> |</li>
        <li><a href="../../index.html">FFPopSim 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Fabio Zanini, Richard Neher.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>