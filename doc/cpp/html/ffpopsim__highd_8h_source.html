<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>FFPopSim: src/ffpopsim_highd.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FFPopSim
   </div>
   <div id="projectbrief">Library for Population Genetics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ffpopsim__highd_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ffpopsim_highd.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ffpopsim__highd_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#ifndef FFPOPSIM_HIGHD_H_</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define FFPOPSIM_HIGHD_H_</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="ffpopsim__generic_8h.html">ffpopsim_generic.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#ac550679ab4c4d46d550da8ee9120cfbf">   42</a></span>&#160;<span class="preprocessor">#define HCF_MEMERR -131545</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a771f0b45e8f16f6c184b0a672005f255">   43</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HCF_BADARG -131546</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a28143ccee1403a65c35ee37dfd4827db">   44</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HCF_VERBOSE 0</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a6b0935026b61d08b1c2b1a12234d2480">   45</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define WORDLENGTH 28   //length used to chop bitsets into words</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="code" href="structcoeff__t.html">   57</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcoeff__t.html" title="Trait coefficient for a set of loci.">coeff_t</a> {</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="code" href="structcoeff__t.html#a3894225a38d017bb2137736dd74f97af">   58</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="structcoeff__t.html#a3894225a38d017bb2137736dd74f97af">order</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="code" href="structcoeff__t.html#a0323a373284fc74261c9e4b2ef02c019">   59</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structcoeff__t.html#a0323a373284fc74261c9e4b2ef02c019">value</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="code" href="structcoeff__t.html#a9c8458e741f97dec0fee3ac9c19010f8">   60</a></span>&#160;        <span class="keywordtype">int</span> *<a class="code" href="structcoeff__t.html#a9c8458e741f97dec0fee3ac9c19010f8">loci</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="code" href="structcoeff__t.html#a78aaea96423b16703441101f59407e93">   61</a></span>&#160;        <a class="code" href="structcoeff__t.html#a78aaea96423b16703441101f59407e93">coeff_t</a>(<span class="keywordtype">double</span> value_in, vector &lt;int&gt; loci_in){</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                value=value_in;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                order=loci_in.size();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                loci=<span class="keyword">new</span> <span class="keywordtype">int</span> [order];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;order; i++) loci[i]=loci_in[i];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;};</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="code" href="structcoeff__single__locus__t.html">   75</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcoeff__single__locus__t.html" title="Trait coefficient for a single locus.">coeff_single_locus_t</a> {</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="code" href="structcoeff__single__locus__t.html#a59b1b14732929f2915ae02cd54a79b31">   76</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structcoeff__single__locus__t.html#a59b1b14732929f2915ae02cd54a79b31">value</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="code" href="structcoeff__single__locus__t.html#a552dfe9170c4b528157bd8c98c048877">   77</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="structcoeff__single__locus__t.html#a552dfe9170c4b528157bd8c98c048877">locus</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="code" href="structcoeff__single__locus__t.html#aeae26a72c110e8045242fdd7d5d8eb65">   78</a></span>&#160;        <a class="code" href="structcoeff__single__locus__t.html#aeae26a72c110e8045242fdd7d5d8eb65">coeff_single_locus_t</a>(<span class="keywordtype">double</span> value_in, <span class="keywordtype">int</span> locus_in) : value(value_in), locus(locus_in) {};</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;};</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="code" href="classhypercube__highd.html">   95</a></span>&#160;<span class="keyword">class </span><a class="code" href="classhypercube__highd.html" title="Hypercube class for high-dimensional simulations.">hypercube_highd</a> {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="comment">// random number generator</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        gsl_rng *rng;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seed;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// memory management</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordtype">bool</span> hcube_allocated;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordtype">bool</span> mem;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">int</span> allocate_mem();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">int</span> free_mem();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// iterators</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        vector&lt;coeff_single_locus_t&gt;::iterator coefficients_single_locus_iter;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        vector&lt;coeff_t&gt;::iterator coefficients_epistasis_iter;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// static array of single locus coefficients (for performance reasons)</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        vector&lt;double&gt; coefficients_single_locus_static;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// random number generator</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#a67a246e33192b2595c530360dd6174b7">  116</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhypercube__highd.html#a67a246e33192b2595c530360dd6174b7">rng_offset</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">// attributes</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#afdf4a62edd66fb7caf44a03a8c56a98d">  119</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhypercube__highd.html#afdf4a62edd66fb7caf44a03a8c56a98d">dim</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#a448adc68ed5b8a883dfc6f4ce497f36c">  120</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhypercube__highd.html#a448adc68ed5b8a883dfc6f4ce497f36c">hypercube_mean</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#a803f1c2d636e60da55da65c033d5a491">  121</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhypercube__highd.html#a803f1c2d636e60da55da65c033d5a491">epistatic_std</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#a21b3e86447b5373763c72888bf182dda">  122</a></span>&#160;        vector &lt;coeff_single_locus_t&gt; <a class="code" href="classhypercube__highd.html#a21b3e86447b5373763c72888bf182dda">coefficients_single_locus</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#ab7af876af26864a914e4957113ca58e2">  123</a></span>&#160;        vector &lt;coeff_t&gt; <a class="code" href="classhypercube__highd.html#ab7af876af26864a914e4957113ca58e2">coefficients_epistasis</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// setting up</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="classhypercube__highd.html" title="Hypercube class for high-dimensional simulations.">hypercube_highd</a>();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="classhypercube__highd.html" title="Hypercube class for high-dimensional simulations.">hypercube_highd</a>(<span class="keywordtype">int</span> dim_in, <span class="keywordtype">int</span> s=0);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keyword">virtual</span> ~<a class="code" href="classhypercube__highd.html" title="Hypercube class for high-dimensional simulations.">hypercube_highd</a>();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordtype">int</span> set_up(<span class="keywordtype">int</span> dim_in,  <span class="keywordtype">int</span> s=0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// get methods</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#a431d9efd0e8d1355bc2496e809d93c9c">  132</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classhypercube__highd.html#a431d9efd0e8d1355bc2496e809d93c9c">get_dim</a>(){<span class="keywordflow">return</span> dim;}</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="code" href="classhypercube__highd.html#a08ca2ef3718e7bc6ef3ac1a08d9daa73">  133</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classhypercube__highd.html#a08ca2ef3718e7bc6ef3ac1a08d9daa73">get_seed</a>() {<span class="keywordflow">return</span> seed;};</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">double</span> get_func(boost::dynamic_bitset&lt;&gt;&amp; genotype);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordtype">double</span> get_additive_coefficient(<span class="keywordtype">int</span> locus);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">double</span> get_func_diff(boost::dynamic_bitset&lt;&gt;&amp; genotype1, boost::dynamic_bitset&lt;&gt;&amp; genotype2, vector&lt;int&gt; &amp;diffpos);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// change the hypercube</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordtype">void</span> reset();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">void</span> reset_additive();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordtype">int</span> set_additive_coefficient(<span class="keywordtype">double</span> value, <span class="keywordtype">int</span> locus, <span class="keywordtype">int</span> expected_locus=-1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">int</span> add_coefficient(<span class="keywordtype">double</span> value, vector &lt;int&gt; loci);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">int</span> set_random_epistasis_strength(<span class="keywordtype">double</span> sigma);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;};</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">// Control constants</span></div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#af50d111882971f48a393dc16fc0e1bc4">  148</a></span>&#160;<span class="preprocessor">#define HP_VERBOSE 0</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a6c6f7646a646567b45b33d384d2e0770">  149</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define NO_GENOTYPE -1</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a7a2309399840f46073a6a2043f6efc01">  150</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_MINAF 0.02</span></div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a4b60f38477e596592773796f58ac4381">  151</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define MAX_DELTAFITNESS 8</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a36d37e90dca769118510b4fb805128db">  152</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define MAX_POPSIZE 500000</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a99d8cf643323773f4c4016e2a6a0829a">  153</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_NOTHING 1e-12</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a3f0086d9024eec2e073aff83b91a3816">  154</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_RANDOM_SAMPLE_FRAC 0.01</span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a620886f0888c07b3d154256a7f4ab883">  155</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define FREE_RECOMBINATION 1</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#ac5b596a182f64d36e97e58d7bc720922">  156</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CROSSOVERS 2</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// Error Codes</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a1d8384710b58dca31e897b4cc1160f47">  159</a></span>&#160;<span class="preprocessor">#define HP_BADARG -879564</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#ad8a404480e6ed830b0f74d60b8fbf97c">  160</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_MEMERR -986465</span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a167eef455dfa2cc967449e6564041c35">  161</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_EXPLOSIONWARN 4</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a3748580afb9981f7e270db95c8f8ee61">  162</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_EXTINCTERR 5</span></div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a791c0fc1e068e6986b5d944e329600f8">  163</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_NOBINSERR 6</span></div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#aeb3b7ef01302d85a7a22c2d159b7d4a7">  164</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_WRONGBINSERR 7</span></div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="code" href="ffpopsim__highd_8h.html#a9519086492ad7baa22bdabb4eb743f05">  165</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define HP_RUNTIMEERR 8</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="code" href="structclone__t.html">  172</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> {</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">  173</a></span>&#160;        boost::dynamic_bitset&lt;&gt; <a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">genotype</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="code" href="structclone__t.html#a21a7fac413eb801144e93fe478e90e60">  174</a></span>&#160;        vector &lt;double&gt; <a class="code" href="structclone__t.html#a21a7fac413eb801144e93fe478e90e60">trait</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">  175</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="code" href="structclone__t.html#a43d78b6f1a0abac5d98075fd913aafc5">  176</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="structclone__t.html#a43d78b6f1a0abac5d98075fd913aafc5">clone_size</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="code" href="structclone__t.html#a9b7fd5efd2655e184df2901100767120">  177</a></span>&#160;        <a class="code" href="structclone__t.html#a9b7fd5efd2655e184df2901100767120">clone_t</a>(<span class="keywordtype">int</span> n_traits=0) : genotype(boost::dynamic_bitset&lt;&gt;(0)), trait(n_traits, 0), fitness(0), clone_size(0) {};</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// Comparison operators check fitness first, genome (big endian) last</span></div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="code" href="structclone__t.html#a6db725d831f1eb0e1944fa0911f7b721">  180</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="structclone__t.html#a6db725d831f1eb0e1944fa0911f7b721">operator==</a>(<span class="keyword">const</span> <a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> &amp;other)<span class="keyword"> const </span>{<span class="keywordflow">return</span> (fitness == other.<a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>) &amp;&amp; (genotype == other.<a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">genotype</a>);}</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="code" href="structclone__t.html#a67412b5eb925df9568adaad84ddfb24f">  181</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="structclone__t.html#a67412b5eb925df9568adaad84ddfb24f">operator!=</a>(<span class="keyword">const</span> <a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> &amp;other)<span class="keyword"> const </span>{<span class="keywordflow">return</span> (fitness != other.<a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>) || (genotype != other.<a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">genotype</a>);}</div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="code" href="structclone__t.html#ab83eff4b44d58eb53b77ec8b3d246afd">  182</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="structclone__t.html#ab83eff4b44d58eb53b77ec8b3d246afd">operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> &amp;other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="keywordflow">if</span>(fitness &lt; other.<a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fitness &gt; other.<a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i &lt; genotype.size(); i++) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                <span class="keywordflow">if</span>((!genotype[i]) &amp;&amp; (other.<a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">genotype</a>[i])) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span>((genotype[i]) &amp;&amp; (!other.<a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">genotype</a>[i])) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        }</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="code" href="structclone__t.html#a091e401288cdf3826d7d602d28e2f438">  193</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="structclone__t.html#a091e401288cdf3826d7d602d28e2f438">operator&gt;</a>(<span class="keyword">const</span> <a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> &amp;other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">if</span>(fitness &gt; other.<a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fitness &lt; other.<a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i &lt; genotype.size(); i++) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                <span class="keywordflow">if</span>((genotype[i]) &amp;&amp; (!other.<a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">genotype</a>[i])) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span>((!genotype[i]) &amp;&amp; (other.<a class="code" href="structclone__t.html#a284f9aafc6cfc64c135834085d876c70">genotype</a>[i])) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;};</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="code" href="classhaploid__highd.html">  219</a></span>&#160;<span class="keyword">class </span><a class="code" href="classhaploid__highd.html" title="Population class for high-dimensional simulations.">haploid_highd</a> {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// genotype to traits maps, which in turn are used in the trait-to-fitness map</span></div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a3faa49df0828300313fb979e29b53bd8">  222</a></span>&#160;        <a class="code" href="classhypercube__highd.html" title="Hypercube class for high-dimensional simulations.">hypercube_highd</a> *<a class="code" href="classhaploid__highd.html#a3faa49df0828300313fb979e29b53bd8">trait</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">// pointers to the current population and the temporary one</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a7b2a100e6109b0190f3435b08097c327">  225</a></span>&#160;        vector &lt;clone_t&gt; *<a class="code" href="classhaploid__highd.html#a7b2a100e6109b0190f3435b08097c327">current_pop</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ad0f15c886bb03789063f5587e080166e">  226</a></span>&#160;        vector &lt;clone_t&gt; *<a class="code" href="classhaploid__highd.html#ad0f15c886bb03789063f5587e080166e">new_pop</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">// construction / destruction</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="classhaploid__highd.html" title="Population class for high-dimensional simulations.">haploid_highd</a>(<span class="keywordtype">int</span> L=0, <span class="keywordtype">int</span> rng_seed=0, <span class="keywordtype">int</span> number_of_traits=1);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keyword">virtual</span> ~<a class="code" href="classhaploid__highd.html" title="Population class for high-dimensional simulations.">haploid_highd</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="comment">// population parameters (read/write)</span></div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#aa496b4cc82e39329cc6d18b1432cd515">  233</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#aa496b4cc82e39329cc6d18b1432cd515">carrying_capacity</a>;                  <span class="comment">// carrying capacity of the environment (pop size)</span></div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ad55b1105f6869684863c7e4f34023827">  234</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#ad55b1105f6869684863c7e4f34023827">mutation_rate</a>;                   <span class="comment">// rate of mutation per locus per generation</span></div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a4dc7a29976c59a5c4755d12ade075069">  235</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a4dc7a29976c59a5c4755d12ade075069">outcrossing_rate</a>;                <span class="comment">// probability of having sex</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a023aab1a8360b632e471bdc3a4ec37d1">  236</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a023aab1a8360b632e471bdc3a4ec37d1">crossover_rate</a>;                  <span class="comment">// rate of crossover during sex</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#afa9a75efb02352d951e633f31ac1bc59">  237</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#afa9a75efb02352d951e633f31ac1bc59">recombination_model</a>;                <span class="comment">//model of recombination to be used</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#abc8e66940a4dd00a25388ec322cf7a49">  238</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classhaploid__highd.html#abc8e66940a4dd00a25388ec322cf7a49">circular</a>;                          <span class="comment">//topology of the chromosome</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// population parameters (read only)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a246641ceeb4e3a8a7168426fc2bba212">  241</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a246641ceeb4e3a8a7168426fc2bba212">L</a>(){<span class="keywordflow">return</span> number_of_loci;}</div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a303677b163c6b7edbf5f39a63ab84693">  242</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a303677b163c6b7edbf5f39a63ab84693">get_number_of_loci</a>(){<span class="keywordflow">return</span> number_of_loci;}</div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#aaa0a39abeeb60600158b8430739280ec">  243</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#aaa0a39abeeb60600158b8430739280ec">N</a>(){<span class="keywordflow">return</span> population_size;}</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a5f2fe58daa26fce5a3cea94adf92fe97">  244</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a5f2fe58daa26fce5a3cea94adf92fe97">get_population_size</a>() {<span class="keywordflow">return</span> population_size;}</div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a3a2a61046b0810e5b7b3794b49434aad">  245</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a3a2a61046b0810e5b7b3794b49434aad">get_generation</a>(){<span class="keywordflow">return</span> generation;}</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a6e915dc6199d83ba2e35b3195b5b03b9">  246</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a6e915dc6199d83ba2e35b3195b5b03b9">get_number_of_clones</a>(){<span class="keywordflow">return</span> current_pop-&gt;size();}</div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a9e28c79bc0f9f68d705e0bf1643481f8">  247</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a9e28c79bc0f9f68d705e0bf1643481f8">get_number_of_traits</a>(){<span class="keywordflow">return</span> number_of_traits;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="comment">// initialization</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordtype">int</span> set_allele_frequencies(<span class="keywordtype">double</span> *freq, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> N);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordtype">int</span> set_genotypes(vector &lt;genotype_value_pair_t&gt; gt);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordtype">int</span> set_wildtype(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> N);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// modify population</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordtype">void</span> add_genotypes(boost::dynamic_bitset&lt;&gt; genotype_in, <span class="keywordtype">int</span> n=1);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">// modify traits</span></div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ac9da76630ffc3a1581f44f3e94004854">  258</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#ac9da76630ffc3a1581f44f3e94004854">add_trait_coefficient</a>(<span class="keywordtype">double</span> value, vector &lt;int&gt; loci, <span class="keywordtype">int</span> t=0){<span class="keywordflow">return</span> trait[t].add_coefficient(value, loci);}</div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a0a5523161a38427a7bdcc18136751817">  259</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classhaploid__highd.html#a0a5523161a38427a7bdcc18136751817">clear_trait</a>(<span class="keywordtype">int</span> t=0){<span class="keywordflow">if</span>(t &gt;= number_of_traits) <span class="keywordflow">throw</span> (<span class="keywordtype">int</span>)<a class="code" href="ffpopsim__highd_8h.html#a1d8384710b58dca31e897b4cc1160f47">HP_BADARG</a>; <span class="keywordflow">else</span> trait[t].reset();}</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#acc3e232638ff352b52a4c8db9b729a23">  260</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classhaploid__highd.html#acc3e232638ff352b52a4c8db9b729a23">clear_traits</a>(){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> t=0; t&lt;number_of_traits; t++){trait[t].reset();}}</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ae8d94a3616a3c1ffdb07844fbd0349aa">  261</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classhaploid__highd.html#ae8d94a3616a3c1ffdb07844fbd0349aa">set_random_trait_epistasis</a>(<span class="keywordtype">double</span> epistasis_std,<span class="keywordtype">int</span> traitnumber=0){trait[traitnumber].epistatic_std=epistasis_std;}</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">// modify fitness (shortcuts: they only make sense if number_of_traits=1)</span></div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#af785069be8a626717d8e705b407e76a6">  264</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#af785069be8a626717d8e705b407e76a6">add_fitness_coefficient</a>(<span class="keywordtype">double</span> value, vector &lt;int&gt; loci){<span class="keywordflow">if</span>(number_of_traits&gt;1) <span class="keywordflow">throw</span> (<span class="keywordtype">int</span>)<a class="code" href="ffpopsim__highd_8h.html#a1d8384710b58dca31e897b4cc1160f47">HP_BADARG</a>; <span class="keywordflow">return</span> add_trait_coefficient(value, loci, 0);}</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a298bdd5103be21db9f72fb72685cd414">  265</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classhaploid__highd.html#a298bdd5103be21db9f72fb72685cd414">clear_fitness</a>(){<span class="keywordflow">if</span>(number_of_traits&gt;1){<span class="keywordflow">if</span>(<a class="code" href="ffpopsim__highd_8h.html#af50d111882971f48a393dc16fc0e1bc4">HP_VERBOSE</a>) cerr&lt;&lt;<span class="stringliteral">&quot;What do you mean by fitness?&quot;</span>&lt;&lt;endl; <span class="keywordflow">throw</span> (<span class="keywordtype">int</span>)<a class="code" href="ffpopsim__highd_8h.html#a1d8384710b58dca31e897b4cc1160f47">HP_BADARG</a>;} clear_traits();}</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a0a7af3cbfabcbf0b3b01e4bcffd87425">  266</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classhaploid__highd.html#a0a7af3cbfabcbf0b3b01e4bcffd87425">set_random_epistasis</a>(<span class="keywordtype">double</span> epistasis_std){<span class="keywordflow">if</span>(number_of_traits&gt;1){<span class="keywordflow">if</span>(<a class="code" href="ffpopsim__highd_8h.html#af50d111882971f48a393dc16fc0e1bc4">HP_VERBOSE</a>) cerr&lt;&lt;<span class="stringliteral">&quot;Please use set_random_trait_epistasis.&quot;</span>&lt;&lt;endl; <span class="keywordflow">throw</span> (<span class="keywordtype">int</span>)<a class="code" href="ffpopsim__highd_8h.html#a1d8384710b58dca31e897b4cc1160f47">HP_BADARG</a>;} trait[0].epistatic_std=epistasis_std;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// evolution</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordtype">int</span> evolve(<span class="keywordtype">int</span> gen=1);  </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordtype">int</span> bottleneck(<span class="keywordtype">int</span> size_of_bottleneck);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// update traits and fitness and calculate statistics</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordtype">void</span> calc_stat();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordtype">void</span> unique_clones();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// readout</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// Note: these functions are for the general public and are not expected to be</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">// extremely fast. If speed is a major concern, consider subclassing and working</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">// with protected methods.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// random clones</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordtype">int</span> random_clone();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordtype">int</span> random_clones(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_o_individuals, vector &lt;int&gt; *<a class="code" href="classsample.html" title="Sample of any scalar property.">sample</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// genotype readout</span></div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a2f6a793822b830dbb67fdb2d22c22194">  287</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="classhaploid__highd.html#a2f6a793822b830dbb67fdb2d22c22194">get_genotype_string</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i){<span class="keywordtype">string</span> gts; boost::to_string((*current_pop)[i].genotype, gts); <span class="keywordflow">return</span> gts;}</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a686aa6ae9c4d31f96dd6bb3d83d11188">  288</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a686aa6ae9c4d31f96dd6bb3d83d11188">distance_Hamming</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> clone1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> clone2, vector &lt;unsigned int *&gt; *chunks=NULL, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> every=1){<span class="keywordflow">return</span> <a class="code" href="classhaploid__highd.html#a686aa6ae9c4d31f96dd6bb3d83d11188">distance_Hamming</a>((*current_pop)[clone1].genotype, (*current_pop)[clone2].genotype, chunks, every);}</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordtype">int</span> distance_Hamming(boost::dynamic_bitset&lt;&gt; gt1, boost::dynamic_bitset&lt;&gt; gt2, vector&lt;unsigned int *&gt; *chunks=NULL, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> every=1);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="structstat__t.html" title="Structure for short summary statistics.">stat_t</a> get_diversity_statistics(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sample=1000);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="structstat__t.html" title="Structure for short summary statistics.">stat_t</a> get_divergence_statistics(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sample=1000);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">// allele frequencies</span></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a0c1eb3defc6dbf00e414482ae39355e2">  294</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a0c1eb3defc6dbf00e414482ae39355e2">get_allele_frequency</a>(<span class="keywordtype">int</span> l) {<span class="keywordflow">return</span> allele_frequencies[l];}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordtype">double</span> get_pair_frequency(<span class="keywordtype">int</span> locus1, <span class="keywordtype">int</span> locus2);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        vector &lt;double&gt; get_pair_frequencies(vector &lt; vector &lt;int&gt; &gt; *loci);</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ad94f599d9a5c7e3a13afe96a0a240d73">  297</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#ad94f599d9a5c7e3a13afe96a0a240d73">get_chi</a>(<span class="keywordtype">int</span> l) {<span class="keywordflow">return</span> 2*allele_frequencies[l]-1.0;}</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a2e29536be4ec4c75d2889e5a2a28642e">  298</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a2e29536be4ec4c75d2889e5a2a28642e">get_participation_ratio</a>(){<span class="keywordflow">return</span> participation_ratio;};</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">//      double get_multi_point_frequency(vector &lt;int&gt; loci);</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// fitness/phenotype readout</span></div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ac6029079cbb7ff559ed75b581ff8deef">  302</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#ac6029079cbb7ff559ed75b581ff8deef">get_fitness</a>(<span class="keywordtype">int</span> n) {calc_individual_fitness(&amp;((*current_pop)[n])); <span class="keywordflow">return</span> (*current_pop)[n].fitness;}</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a8351db0129fbfb98170f0b60565c9dc3">  303</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a8351db0129fbfb98170f0b60565c9dc3">get_clone_size</a>(<span class="keywordtype">int</span> n) {<span class="keywordflow">return</span> (*current_pop)[n].clone_size;}</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a1da3a90a51c42ccccbd9c47a93817052">  304</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a1da3a90a51c42ccccbd9c47a93817052">get_trait</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> t=0) {calc_individual_traits(&amp;((*current_pop)[n])); <span class="keywordflow">return</span> (*current_pop)[n].trait[t];}</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a4271fb90101fdea28032029efffbd395">  305</a></span>&#160;        <a class="code" href="structstat__t.html" title="Structure for short summary statistics.">stat_t</a> <a class="code" href="classhaploid__highd.html#a4271fb90101fdea28032029efffbd395">get_fitness_statistics</a>() {update_fitness(); calc_fitness_stat(); <span class="keywordflow">return</span> fitness_stat;}</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a3554acf03e30ec4df69de98c29e1b2a8">  306</a></span>&#160;        <a class="code" href="structstat__t.html" title="Structure for short summary statistics.">stat_t</a> <a class="code" href="classhaploid__highd.html#a3554acf03e30ec4df69de98c29e1b2a8">get_trait_statistics</a>(<span class="keywordtype">int</span> t=0) {calc_trait_stat(); <span class="keywordflow">return</span> trait_stat[t];}</div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a5c6adc6e23625ec7eda23253074b564c">  307</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a5c6adc6e23625ec7eda23253074b564c">get_trait_covariance</a>(<span class="keywordtype">int</span> t1, <span class="keywordtype">int</span> t2) {calc_trait_stat(); <span class="keywordflow">return</span> trait_covariance[t1][t2];}</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a7d00bee54a9dcddcec55d873545047cb">  308</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a7d00bee54a9dcddcec55d873545047cb">get_max_fitness</a>() {<span class="keywordflow">return</span> fitness_max;}</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordtype">void</span> update_traits();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordtype">void</span> update_fitness();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="comment">// histograms</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordtype">int</span> get_divergence_histogram(gsl_histogram **hist, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins=10, vector &lt;unsigned int *&gt; *chunks=NULL, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> every=1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sample=1000);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">int</span> get_diversity_histogram(gsl_histogram **hist, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins=10, vector &lt;unsigned int *&gt; *chunks=NULL, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> every=1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sample=1000);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordtype">int</span> get_fitness_histogram(gsl_histogram **hist, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins=10, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sample=1000);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// stream I/O</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordtype">int</span> print_allele_frequencies(ostream &amp;out);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordtype">int</span> read_ms_sample(istream &amp;gts, <span class="keywordtype">int</span> skip_locus, <span class="keywordtype">int</span> multiplicity);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordtype">int</span> read_ms_sample_sparse(istream &amp;gts, <span class="keywordtype">int</span> skip_locus, <span class="keywordtype">int</span> multiplicity, <span class="keywordtype">int</span> distance);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// random number generator</span></div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#afe01d72044a8d81a32694287aa68ef09">  324</a></span>&#160;        gsl_rng* <a class="code" href="classhaploid__highd.html#afe01d72044a8d81a32694287aa68ef09">evo_generator</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a9395ef40e6478fbc361c82193377346e">  325</a></span>&#160;        gsl_rng* <a class="code" href="classhaploid__highd.html#a9395ef40e6478fbc361c82193377346e">label_generator</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a1d7ee5c309f75b8b5d97f087569c532d">  326</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a1d7ee5c309f75b8b5d97f087569c532d">seed</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordtype">int</span> get_random_seed();</div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a1c647247fb891a314caf21b58f5a1e0d">  328</a></span>&#160;        vector &lt;int&gt; <a class="code" href="classhaploid__highd.html#a1c647247fb891a314caf21b58f5a1e0d">random_sample</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordtype">void</span> produce_random_sample(<span class="keywordtype">int</span> size=1000);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">// population parameters</span></div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ad1a76259095c3119e33fcc63abd52227">  332</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#ad1a76259095c3119e33fcc63abd52227">number_of_loci</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a13f8881a0a81b4cc1ac3fe23e95c27fd">  333</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a13f8881a0a81b4cc1ac3fe23e95c27fd">population_size</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#af9bef51d5530a1807d79063fcaf81363">  334</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#af9bef51d5530a1807d79063fcaf81363">number_of_traits</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ad364734ea945abb84658303eefa0d817">  335</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#ad364734ea945abb84658303eefa0d817">scratch</a>;                    <span class="comment">//variable by how much the memory for offsprings exceeds the number_of_individuals (1+scratch)*..</span></div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a771e8b659f399927ed612ba2f01c7ef8">  336</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classhaploid__highd.html#a771e8b659f399927ed612ba2f01c7ef8">generation</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="comment">// evolution</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordtype">int</span> mutate();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordtype">int</span> select_gametes();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordtype">double</span> relaxation_value();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordtype">double</span> get_logmean_expfitness();        <span class="comment">// Log of the population exp-average of the fitness: log[&lt;exp(F)&gt;_{population}]</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordtype">void</span> flip_single_locus(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> clonenum, <span class="keywordtype">int</span> locus);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordtype">int</span> flip_single_locus(<span class="keywordtype">int</span> locus);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordtype">void</span> shuffle_genotypes();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordtype">int</span> swap_populations();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordtype">int</span> new_generation();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">// clone structure</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordtype">int</span> partition_cumulative(vector &lt;unsigned int&gt; &amp;partition_cum);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">// allele_frequencies</span></div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a2929fa585f451eff209d5766e280d0b6">  354</a></span>&#160;        <span class="keywordtype">double</span> *<a class="code" href="classhaploid__highd.html#a2929fa585f451eff209d5766e280d0b6">allele_frequencies</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#abcade2de00cd6efee795651d46eede3a">  355</a></span>&#160;        <span class="keywordtype">double</span> *<a class="code" href="classhaploid__highd.html#abcade2de00cd6efee795651d46eede3a">gamete_allele_frequencies</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a1f25e3ce87377569a3b14c92bb72fc55">  356</a></span>&#160;        <span class="keywordtype">double</span> *<a class="code" href="classhaploid__highd.html#a1f25e3ce87377569a3b14c92bb72fc55">chi1</a>;                           <span class="comment">//symmetric allele frequencies</span></div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a0047d21da6fe6fa9c1ce94b7b53ae37a">  357</a></span>&#160;        <span class="keywordtype">double</span> **<a class="code" href="classhaploid__highd.html#a0047d21da6fe6fa9c1ce94b7b53ae37a">chi2</a>;                          <span class="comment">//symmetric two locus correlations</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordtype">void</span> calc_allele_freqs();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// recombination details</span></div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ac0c344e3d804d8f788ea527167a9bddc">  361</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#ac0c344e3d804d8f788ea527167a9bddc">outcrossing_rate_effective</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a8a44ffb375d6763ebdef28d9e5121d8d">  362</a></span>&#160;        <span class="keywordtype">int</span> *<a class="code" href="classhaploid__highd.html#a8a44ffb375d6763ebdef28d9e5121d8d">genome</a>;                            <span class="comment">//Auxiliary array holding the positions along the genome</span></div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a495c975322ea03d01417be29e951a1f0">  363</a></span>&#160;        <span class="keywordtype">int</span> *<a class="code" href="classhaploid__highd.html#a495c975322ea03d01417be29e951a1f0">crossovers</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        boost::dynamic_bitset&lt;&gt; reassortment_pattern();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        boost::dynamic_bitset&lt;&gt; crossover_pattern();</div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a720e92ddf95f0aaf1e5136b60b53caad">  366</a></span>&#160;        vector &lt;int&gt; <a class="code" href="classhaploid__highd.html#a720e92ddf95f0aaf1e5136b60b53caad">sex_gametes</a>;               <span class="comment">//array holding the indices of gametes</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordtype">int</span> add_recombinants();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordtype">int</span> recombine(<span class="keywordtype">int</span> parent1, <span class="keywordtype">int</span> parent2);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordtype">int</span> recombine_crossover(<span class="keywordtype">int</span> parent1, <span class="keywordtype">int</span> parent2, <span class="keywordtype">int</span> ng);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">// fitness and traits</span></div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a1a57b48e7395ef197c38c46329af820a">  372</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#a1a57b48e7395ef197c38c46329af820a">fitness_max</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#ae57c154a248e0cfe9be446a04d1765d5">  373</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classhaploid__highd.html#ae57c154a248e0cfe9be446a04d1765d5">participation_ratio</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#aa3cd0c02607b41b378f7fa488d5b5b46">  374</a></span>&#160;        <a class="code" href="structstat__t.html" title="Structure for short summary statistics.">stat_t</a> <a class="code" href="classhaploid__highd.html#aa3cd0c02607b41b378f7fa488d5b5b46">fitness_stat</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a97fe03c6b3b3034410d728f17fa2716b">  375</a></span>&#160;        <a class="code" href="structstat__t.html" title="Structure for short summary statistics.">stat_t</a> *<a class="code" href="classhaploid__highd.html#a97fe03c6b3b3034410d728f17fa2716b">trait_stat</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a870cd9eb97be85b79de12baba7231aa7">  376</a></span>&#160;        <span class="keywordtype">double</span> **<a class="code" href="classhaploid__highd.html#a870cd9eb97be85b79de12baba7231aa7">trait_covariance</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordtype">void</span> calc_fitness_stat();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordtype">void</span> calc_trait_stat();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordtype">void</span> calc_individual_traits(<a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> *tempgt);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordtype">void</span> calc_individual_fitness(<a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> *tempgt);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> calc_individual_fitness_from_traits(<a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> *tempgt);      <span class="comment">// this must be virtual, because the fitness landscape on the (genotype x phenotype) space can be wild (here fitness IS the only trait)</span></div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="code" href="classhaploid__highd.html#a0d929c061bbf1c2fd4d82f6bb2f2f998">  382</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classhaploid__highd.html#a0d929c061bbf1c2fd4d82f6bb2f2f998">check_individual_maximal_fitness</a>(<a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> *tempgt){fitness_max = fmax(fitness_max, tempgt-&gt;<a class="code" href="structclone__t.html#a3006dcc4159a072e1c264f37c3a1b0b0">fitness</a>);}</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordtype">double</span> get_trait_difference(<a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> *tempgt1, <a class="code" href="structclone__t.html" title="clone with a single genotype and a vector of phenotypic traits.">clone_t</a> *tempgt2, vector&lt;int&gt;&amp; diffpos, <span class="keywordtype">int</span> traitnum);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// Memory management is private, subclasses must take care only of their own memory</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordtype">bool</span> mem;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordtype">bool</span> cumulants_mem;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordtype">int</span> allocate_mem();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordtype">int</span> free_mem();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">// These two vectors are referenced by subclasses and programs using their pointers,</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">// current_pop and new_pop, which are public. In fact, these vectors are created only</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// to ensure their memory is released upon destruction of the class.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        vector &lt;clone_t&gt; current_pop_vector;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        vector &lt;clone_t&gt; new_pop_vector;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">// counting reference</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">size_t</span> number_of_instances;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;};</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* FFPOPSIM_HIGHD_H_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="ffpopsim__highd_8h.html">ffpopsim_highd.h</a></li>
    <li class="footer">Generated on Fri Aug 24 2012 11:30:08 for FFPopSim by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
